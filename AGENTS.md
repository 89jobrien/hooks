# Repository Guidelines

## Project Structure & Module Organization
- `internal/hooks/`: core hook logic in a single `hooks` package. Each hook is a pure function in its own file pair, e.g., `audit.go` + `audit_test.go`.
- `cmd/<hook-name>/`: one thin binary per hook (stdin → hook → JSON stdout). Example: `cmd/branch-guard/main.go`.
- `cmd/gen-config/`: config generator that turns `config.yaml` into `.cursor/hooks.json` and `.claude/settings.json`.
- `scripts/`: helper scripts (e.g., config sync, summaries).
- `bin/`: built binaries (generated by `make all`).
- `config.yaml`: source of truth for hook configuration.

## Build, Test, and Development Commands
- `make all`: build all hook binaries into `bin/`.
- `make test`: run Go tests (`go test -v -count=1 ./...`).
- `make config`: generate `.cursor/hooks.json`, `.claude/settings.json`, and optional `.cursor/hooks.env` (run from repo root: `make -C hooks config`).
- `make summary`: print recent audit/cost summary (uses `~/.cursor/*` by default).
- `make clean`: remove `bin/`.

## Coding Style & Naming Conventions
- Go code follows `gofmt`; run it before committing.
- Keep all hook logic in `internal/hooks` (single `hooks` package). Avoid adding new packages for hooks.
- File naming: one hook per file pair (`<hook>.go` + `<hook>_test.go`).
- Binary naming: `cmd/<hook-name>/main.go` (kebab-case directory names).

## Testing Guidelines
- Use Go’s standard testing package; tests live alongside hooks in `internal/hooks/`.
- Prefer table-driven tests (see existing `*_test.go` files).
- No explicit coverage target is documented; keep tests focused on behavior and edge cases.

## Commit & Pull Request Guidelines
- Git history is not available in this workspace, so no repository-specific commit pattern can be inferred.
- The `commit-msg-lint` hook enforces Conventional Commits (e.g., `feat: add rate limiter`). Follow that format to avoid blocks.
- PRs should describe the change, the hook(s) touched, and any config updates (e.g., `config.yaml` edits). Include generated files if you ran `make config`.

## Configuration Notes
- Edit `config.yaml` only; generated JSON files are outputs.
- Optional environment overrides live in `.cursor/hooks.env` (created by `make config`). Source it before running Cursor if needed (example: `source .cursor/hooks.env && cursor .`).
